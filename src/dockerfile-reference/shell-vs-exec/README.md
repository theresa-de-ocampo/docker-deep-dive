## Shell and Exec Form

The `RUN`, `CMD`, and `ENTRYPOINT` instructions all have two possible forms:

- `INSTRUCTION command param1 param2` (Shell Form)
- `INSTRUCTION ["executable", "param1", "param2"]` (Exec Form)

The exec form is preferred when you want to execute a command without involving a shell. This form avoids the need to perform shell string munging, and to invoke commands using a specific command shell. It uses a JSON array syntax, where each element in the array is a command, flag, or argument. Docker directly passes the executable and parameters to the main process without involving a shell.

The shell form is more relaxed, and emphasizes ease of use, flexibility, and readability. This form involves a shell to execute a command. The shell is responsible for parsing and interpreting this string, which can sometimes lead to unexpected behavior if the string contains special charaters or complex syntax.

### Shell Features

- The main thing you lose with the exec form is all the useful shell features: sub commands, pipping output, chaining commands, I/O redirection, etc. These kinds of commands are only possible with the shell form.

  ```bash
  FROM ubuntu:latest

  # Shell: run a speed test
  RUN apt-get update \
  && apt-get install -y wget \
  && wget -O /dev/null http://speedtest.wdc01.softlayer.com/downloads/test10.zip \
  && rm -rf /var/lib/apt/lists/*

  # Shell: output the default shell location
  CMD which $(echo $0)
  ```

- In the shell form, commands will inherit environment variables from shell, such as `$HOME` and `$PATH`. However, both forms behave the same when it comes to environment variables set by the `ENV` instruction.

### Signal Trapping

Most shells do not forward process signals to child processes, which means `SIGINT` generated by pressing `CTRL + C` may not stop a child process.

### Recommended Forms

- `RUN` - shell form because of the shell features.
- `ENTRYPOINT` - exec form because of signal trapping.
- `CMD` - exec form because of signal trapping.
